#!/bin/bash
#
# Script to install IBM Cell SDK (Fedora) 3.0 in Fedora 12 (ppc64) on
# Playstation 3. Adds a new repo config (with RPM-GPG-KEY files) to yum
# package manager config dirs, then has yum rebuild its cache. Script assumes
# yum is already configured with (functioning) standard Fedora 12 repos! Use
# my other script (ps3-goodrepos) to configure Fedora 12 repos on your system
# first if needed.
# Happy SPUing!
#
# RUN AS ROOT
#

if [ $(id -u) != 0 ]; then
    printf "Please run script as root.\n"
    exit 1
fi

cp -fv rpm-gpg/RPM-GPG-KEY-cellsdk /etc/pki/rpm-gpg/RPM-GPG-KEY-cellsdk
cp -fv rpm-gpg/RPM-GPG-KEY-cellsdk-open /etc/pki/rpm-gpg/RPM-GPG-KEY-cellsdk-open
cp -fv yum.repos.d/cellsdk.repo /etc/yum.repos.d/cellsdk.repo

yum clean all
yum makecache

yum -y install glibc.ppc glibc.ppc64 glibc-devel.ppc glibc-devel.ppc64 rsync sed ed tcl.ppc tcl.ppc64 tcl-devel.ppc tcl-devel.ppc64 tk.ppc tk.ppc64 tk-devel.ppc tk-devel.ppc64 wget
yum -y groupinstall "Cell Runtime Environment" "Cell Development Tools" "Cell Development Libraries" "Cell Programming Examples"
yum -y install spu-binutils oprofile elfspe2 alf-trace cell-spu-timing cellperfctr-driver cellperfctr-tools dacs-trace numactl.ppc numactl.ppc64 numactl-devel.ppc numactl-devel.ppc64 netpbm.ppc netpbm.ppc64 netpbm-devel.ppc netpbm-devel.ppc64 libspe2.ppc libspe2.ppc64 libspe2-devel.ppc libspe2-devel.ppc64 libspe2-adabinding-devel spu-newlib ppu-gcc-gnat ppu-gcc-fortran spu-gcc-fortran alf-ide-template cell-xlc-ssc-cmp cell-xlc-ssc-help cell-xlc-ssc-lib cell-xlc-ssc-man cell-xlc-ssc-omp cell-xlc-ssc-rte cell-xlc-ssc-rte-lnk cellide ppu-gcc-gnat alf-devel.ppc64 blas-devel.ppc64 ppu-mass-devel.ppc64 ppu-simdmath-devel.ppc64 alf-trace-devel.ppc alf-trace-devel.ppc64 dacs-trace-devel.ppc64 libfft-devel.ppc libmc-rand-devel.ppc pdt-devel.ppc64 spu-timer-devel trace.ppc trace.ppc64 trace-devel.ppc trace-devel.ppc64 alf.ppc64 alf-devel.ppc64 alf-ide-template alf-trace-devel.ppc alf-trace-devel.ppc64 alf-trace.ppc64 blas.ppc64 blas-devel.ppc64 dacs-trace-devel.ppc64 ppu-simdmath ppu-simdmath.ppc64 libfft libfft-devel libfft-examples-source fdprpro pdtr alf-hybrid-examples-source cell-compliance-tests cell-compliance-tests-source libfft-examples-source spu-timer-devel.ppc cell-libs-devel.ppc64

printf "\nREBOOT\n\n"

exit 0

